---
layout:    post
author:    Bennet Carstensen
title:     GCA Part 3 - Nested cross approximation
date:      September 10, 2017
permalink: /blog/gca/3
comments:  true
---

<!-- lint disable no-shortcut-reference-link no-undefined-references-->

The algorithm so far constructs a $$\mathcal{H}$$-matrix approximation of G with
a corresponding block tree $$\mathcal{T}_{\mathcal{I} \times \mathcal{J}}$$ for
cluster trees $$\mathcal{T}_{\mathcal{I}}$$, $$\mathcal{T}_{\mathcal{J}}$$ and
finite index sets $$\mathcal{I}$$ and $$\mathcal{J}$$ with

$$
  G|_{\hat{t} \times \hat{s}} \approx
  \begin{cases}
    G|_{\hat{t} \times \hat{s}}, &
    (t, s) \in \mathcal{L}^{-}_{\mathcal{I} \times \mathcal{J}} \\
    \mathfrak{I}_{t} G|_{\hat{t}\times \hat{s}} =
    V_{t} (P_{t}G|_{\hat{t} \times \hat{s}}), &
    (t, s) \in \mathcal{L}^{+}_{\mathcal{I} \times \mathcal{J}} \\
  \end{cases},
$$

e.g., we approximate the admissible blocks of the farfield by algebraic
interpolation. This approximation is of almost linear complexity with estimates
given by $$O(n \log^{\alpha}(n))$$, with $$\alpha \in \mathbb{R}$$ and
$$n \in \mathbb{N}$$ describing the problem size
[\[9\]]({{ site.baseurl }}/refs). To avoid the logarithmic factor we want to
create a $$\mathcal{H}^2$$-matrix presentation [\[1\]]({{ site.baseurl }}/refs).

<!--more-->

In order for the cluster basis to be able to hanle all block connected to a
given cluster, we have to approximate the entire farfield. Define

$$
  F_{t} := \{ j \in \mathcal{J} : \text{supp } \psi_{j} \subseteq
  \mathcal{F}_{t} \} \qquad \text{for all } t \in \mathcal{T}_{\mathcal{I}}
$$

and use the algorithm to find an interpolation operator
$$\mathfrak{I}_{t} = V_{t} P_{t}$$ such that

$$
  G|_{\hat{t} \times F_{t}} \approx \mathfrak{I}_{t} G|_{\hat{t} \times F_{t}} =
  V_{t} P_{t} G|_{\hat{t} \times F_{t}}.
$$

For the sake of uniformity, we also desire an approximation of the column
clusters. By defining

$$
  F_{s} := \{ i \in \mathcal{I} : \text{supp } \varphi_{i} \subseteq
  \mathcal{F}_{s} \} \qquad \text{for all } s \in \mathcal{T}_{\mathcal{J}},
$$

we can use the algorithm with the transposed matrix to find an interpolation
operator $$\mathfrak{I}_{s} = V_{s} P_{s}$$ such that

<!-- lint disable emphasis-marker-->

$$
  G|_{F_{s} \times \hat{s} }^{*} \approx \mathfrak{I}_{s}
  G|_{F_{s} \times \hat{s} }^{*} =
  V_{s} P_{s} G|_{F_{s} \times \hat{s} }^{*}.
$$

If a block $$b = (t, s)$$ satisfies the strict admissibility condition

$$
  (t, s) \text{ admissible} \Leftrightarrow (\mathcal{B}_{s} \subseteq
  \mathcal{F}_{t} \land \mathcal{B}_{t} \subseteq \mathcal{F}_{s})
  \Leftrightarrow \max(\text{diam}_{\infty}(\mathcal{B}_{t}),
  \text{diam}_{\infty}(\mathcal{B}_{s})) \leq
  \text{dist}_{\infty}(\mathcal{B}_{t}, \mathcal{B}_{s}),
$$

we have $$\hat{s} \subseteq F_{t}$$ and $$\hat{t} \subseteq F_{s}$$ and thus
obtain

$$
  G|_{\hat{t} \times \hat{s}} \approx \mathfrak{I}_{t}
  G|_{\hat{t} \times \hat{s}} \approx \mathfrak{I}_{t}
  G|_{\hat{t} \times \hat{s}} \mathfrak{I}_{s}^{*} = V_{t} P_{t}
  G|_{\hat{t} \times \hat{s}} P_{s}^{*} V_{s}^{*} = V_{t} S_{b} V_{s}^{*}
$$

with

$$
  S_{b} := P_{t} G|_{\hat{t} \times \hat{s}} P_{s}^{*},
$$

e.g., we have constructed a uniform hierarchical matrix.

As a last step, we build nested cluster bases from the available clusters to
assemble a $$\mathcal{H}^2$$-matrix. In order ot keeping it simple, we
restrict ourself to binary cluster tree from which we will construct the cluster
basis recursivly.

Let $$t \in \mathcal{T}_{\mathcal{I}}$$. The current algorithm describes the
procedure for all $$t$$ with $$\text{sons}(t) = \emptyset$$. If
$$\text{sons}(t) \neq \emptyset$$, we have
$$\text{sons}(t) = \{t_{1}, t_{2} \}$$ with $$\mathfrak{I}_{t_{1}} = V_{t_{1}}
P_{t_{1}}$$, $$\mathfrak{I}_{t_{2}} = V_{t_{2}} P_{t_{2}}$$ and

$$
  G|_{\hat{t}_{1} \times F_{t_{1}}} \approx \mathfrak{I}_{t_{1}}
  G|_{\hat{t}_{1} \times F_{t_{1}}}, \qquad
  G|_{\hat{t}_{2} \times F_{t_{2}}} \approx \mathfrak{I}_{t_{2}}
  G|_{\hat{t}_{2} \times F_{t_{2}}}.
$$

Since $$F_{t} \subseteq F_{t_{1}} \cap F_{t_{2}}$$, we have

$$
  \begin{align*}
    G|_{\hat{t} \times F_{t}} &=
    \begin{pmatrix}
      G|_{\hat{t}_{1} \times F_{t_{1}}} \\ G|_{\hat{t}_{2} \times F_{t_{2}}}
    \end{pmatrix} \approx
    \begin{pmatrix}
      \mathfrak{I}_{t_{1}} G|_{\hat{t}_{1} \times F_{t_{1}}} \\
      \mathfrak{I}_{t_{2}} G|_{\hat{t}_{2} \times F_{t_{2}}}
    \end{pmatrix} =
    \begin{pmatrix}
      V_{t_{1}} P_{t_{1}} G|_{\hat{t}_{1} \times F_{t_{1}}} \\
      V_{t_{2}} P_{t_{2}} G|_{\hat{t}_{2} \times F_{t_{2}}}
    \end{pmatrix} =
    \begin{pmatrix}
      V_{t_{1}} & \\
                & V_{t_{2}}
    \end{pmatrix}
    \begin{pmatrix}
      P_{t_{1}} G|_{\hat{t}_{1} \times F_{t_{1}}} \\
      P_{t_{2}} G|_{\hat{t}_{2} \times F_{t_{2}}}
    \end{pmatrix} \\ &=
    \begin{pmatrix}
    V_{t_{1}} & \\
              & V_{t_{2}}
    \end{pmatrix}
    \begin{pmatrix}
    P_{t_{1}} & \\
              & P_{t_{2}}
    \end{pmatrix}
    G|_{\hat{t} \times F_{t}} \approx
    \begin{pmatrix}
      V_{t_{1}} & \\
                & V_{t_{2}}
    \end{pmatrix}
    \begin{pmatrix}
    P_{t_{1}} & \\
              & P_{t_{2}}
    \end{pmatrix}
    A_{t}B^{*}_{tF_{t}}
  \end{align*}
$$

where $$A_{t}$$ and $$B_{tF_{t}}$$ are agin the result from the approximation of
Green's second identity. Instead of performing the cross approximation on

$$
  \begin{pmatrix}
    P_{t_{1}} & \\
              & P_{t_{2}}
  \end{pmatrix}
  A_{t},
$$

we collect the row pivot indices of the cross
approximation of both sons, e.g., we define those indices
$$\tilde{t_{1}} := \{ i_{1, 1}, \cdots, i_{1, k_{1}} \},
\tilde{t_{2}} := \{ i_{2, 1}, \cdots, i_{2, k_{2}} \}$$ and their union
$$\tilde{t} := \tilde{t_{1}} \cup \tilde{t_{2}}$$,
$$k_{1}, k_{2} \in \mathbb{N}$$, and by computing $$A_{\tilde{t}}$$ we achieve

$$
  \begin{pmatrix}
    P_{t_{1}} & \\
              & P_{t_{2}}
  \end{pmatrix}
  A_{t} = A_{\tilde{t}}.
$$

We performe the cross approximation on this matrix and find

$$\hat{\mathfrak{I}_{t}} = \hat{V_{t}} \hat{P_{t}}$$ such that

$$
  A_{\tilde{t}} \approx \hat{V_{t}} \hat{P_{t}} A_{\tilde{t}}.
$$

By defining

$$
  V_{t} :=
  \begin{pmatrix}
    V_{t_{1}} & \\
              & V_{t_{2}}
  \end{pmatrix}
  \hat{V}_{t} \text{and} \qquad P_{t} :=
  \begin{pmatrix}
    P_{t_{1}} & \\
              & P_{t_{2}}
  \end{pmatrix},
$$

we see

$$
  \begin{align*}
    G_{\hat{t}} &\approx
    \begin{pmatrix}
      V_{t_{1}} & \\
                & V_{t_{2}}
    \end{pmatrix}
    A_{\tilde{t}} B^{*}_{\tilde{t}F_{t}} \approx
    \begin{pmatrix}
      V_{t_{1}} & \\
                & V_{t_{2}}
    \end{pmatrix}
    \hat{V_{t}} \hat{P_{t}} A_{\tilde{t}} B^{*}_{\tilde{t}F_{t}} \\ &=
    \begin{pmatrix}
      V_{t_{1}} & \\
                & V_{t_{2}}
    \end{pmatrix}
    \hat{V_{t}} \hat{P_{t}}
    \begin{pmatrix}
      P_{t_{1}} & \\
                & P_{t_{2}}
    \end{pmatrix}
    A_{t} B^{*}_{tF_{t}} = V_{t}P_{t}A_{t}B^{*}_{tF_{t}} \\ &\approx
    V_{t}P_{t}G|_{\hat{t} \times F_{t}} =
    \mathfrak{I}_{t} G|_{\hat{t} \times F_{t}}.
  \end{align*}
$$

Splitting $$\hat{V}_{t}$$ in respect to $$V_{t_{1}}$$ and$$ V_{t_{2}}$$, e.g.,
defining

$$
  \begin{pmatrix} E_{t_{1}} // E_{t_{2}} \end{pmatrix} := \hat{V}_{t}
$$

yields

$$
  V_{t} =
  \begin{pmatrix}
    V_{t_{1}} & \\
              & V_{t_{2}}
  \end{pmatrix}
  \hat{V}_{t} =
  \begin{pmatrix}
    V_{t_{1}} & \\
              & V_{t_{2}}
  \end{pmatrix}
  \begin{pmatrix} E_{t_{1}} // E_{t_{2}} \end{pmatrix} =
  \begin{pmatrix} V_{t_{1}} E_{t_{1}} // V_{t_{2}} E_{t_{2}} \end{pmatrix},
$$

thus we have found a nested cluster basis for $$t$$ by performing hybrid
approximation on the sons as well as the combined matrix resulting from this.
By applying the same procedure on $$G|^{*}_{F_{s} \times s}$$, we achieved
a $$\mathcal{H}^2$$-matrix representation of the initial Galerkin
discretization.
